(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(8),s=a.n(i),o=(a(15),a(3)),h=a(5),l=a(4),u=a(1),c=a(2),d=a(6);a(16);function v(e){for(var t=window.location.search.substring(1).split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if(decodeURIComponent(n[0])===e)return decodeURIComponent(n[1])}}var f=function(e){function t(e){var a;Object(o.a)(this,t),a=Object(h.a)(this,Object(l.a)(t).call(this,e));var n=v("threadCount")||a.props.threadCount||400,r=a.getPinholes(n),i=a.getPinholeNeighbours(r);return a.state={pinholes:r,pinholeNeighbours:i,paths:[],width:64,height:64,resizeListener:void 0,threadCount:n,numThreads:v("nthreads")||a.props.nthreads||5,numCurves:v("ncurves")||a.props.ncurves||5,speed:v("speed")||a.props.speed||64,frame:0,then:performance.now()},a.handleClick=a.handleClick.bind(Object(u.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getPinholes",value:function(e){for(var t=[],a=0;a<=e;a++){for(var n=[],r=1*(2*a/e-1),i=0;i<=e;i++){var s=1*(2*i/e-1),o=.002*(Math.random()-.5),h=.002*(Math.random()-.5);n.push({x:r+o,y:s+h})}t.push(n)}return t}},{key:"getPinholeNeighbours",value:function(e){for(var t=e.length,a=[],n=0;n<=t;n++){for(var r=[],i=0;i<=t;i++){var s=[];n>0&&s.push([n-1,i]),n+1<t&&s.push([n+1,i]),i>0&&s.push([n,i-1]),i+1<t&&s.push([n,i+1]),r.push(s)}a.push(r)}return a}},{key:"regenerate",value:function(){var e=this,t=this.state.threadCount,a=this.getPinholes(t),n=this.getPinholeNeighbours(a);this.setState({pinholes:a,pinholeNeighbours:n},function(){e.generatePaths()})}}]),Object(c.a)(t,[{key:"handleClick",value:function(){this.generatePaths()}},{key:"getRandomPinhole",value:function(){var e=Math.floor(Math.random()*this.state.pinholes.length);return[e,Math.floor(Math.random()*this.state.pinholes[e].length)]}},{key:"generatePaths",value:function(){for(var e=this,t=[],a=0;a<this.state.numThreads;a++){for(var n=this.getRandomPinhole(),r=[n],i=0;i<this.state.numCurves;i++){var s=this.getRandomPinhole(),o=this.getPathBetweenPoints(n,s);r=r.concat(o),n=s}s=r[0],o=this.getPathBetweenPoints(n,s),r=r.concat(o),t.push({path:r,color:this.getRandomColor(),show:Math.random()})}this.setState({paths:t},function(){return e.draw()})}},{key:"getNextPinhole",value:function(e,t){var a=this;return this.state.pinholeNeighbours[e[0]][e[1]].reduce(function(e,n){var r=a.state.pinholes[n[0]][n[1]],i=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2));return i<e[0]?[i,n]:e},[1e5,void 0])[1]}},{key:"getPathBetweenPoints",value:function(e,t){for(var a=[e],n=this.state.pinholes[t[0]][t[1]],r=e;(r=this.getNextPinhole(r,n))[0]!==t[0]||r[1]!==t[1];)a.push(r);return a.push(t),a}},{key:"getRandomColor",value:function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}},{key:"resize",value:function(){var e=this,t=this.refs.canvas,a=this.refs.canvas.parentElement,n=window.getComputedStyle(t,null),r=window.getComputedStyle(a,null),i=a.clientHeight,s=a.clientWidth;i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom),s-=parseFloat(r.paddingLeft)+parseFloat(r.paddingRight),i-=parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth),s-=parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth);var o=Math.min(s,i);this.setState({width:o,height:o},function(){return e.draw()})}},{key:"draw",value:function(){var e=this.refs.canvas.getContext("2d"),t=this.state.width/2,a=this.state.height/2,n=Math.min(t,a),r=this.state.threadCount;e.fillStyle="#c19a6b",e.fillStyle="#F1F1D4",e.beginPath(),e.rect(t-n,a-n,2*n,2*n),e.fill(),e.fillStyle="rgba(255,255,255,0.5)";for(var i=0;i<this.state.pinholes.length;i++){var s=this.state.pinholes[i],o=!0,h=!1,l=void 0;try{for(var u,c=s[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value,v=t+n*d.x,f=a+n*d.y;e.beginPath(),e.arc(v,f,n/r,0,2*Math.PI),e.fill()}}catch(m){h=!0,l=m}finally{try{o||null==c.return||c.return()}finally{if(h)throw l}}}this.renderThreads()}},{key:"renderThreads",value:function(){var e=this.refs.canvas.getContext("2d"),t=this.state.width/2,a=this.state.height/2,n=Math.min(t,a),r=this.state.threadCount,i=this.state.frame;e.lineWidth=1.5*n/r;var s=!0,o=!1,h=void 0;try{for(var l,u=this.state.paths[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var c=l.value;e.strokeStyle=c.color,e.beginPath();var d=!0,v=c.path.length,f=c.show*v,m=i%v,g=m+f,p=c.path.slice(m,g);g>v&&(p=p.concat(c.path.slice(0,g-v)));var y=!0,b=!1,w=void 0;try{for(var C,k=p[Symbol.iterator]();!(y=(C=k.next()).done);y=!0){var P=C.value,x=this.state.pinholes[P[0]][P[1]],S=t+n*x.x,E=a+n*x.y;d?(e.moveTo(S,E),d=!1):(e.lineTo(S,E),d=!0)}}catch(M){b=!0,w=M}finally{try{y||null==k.return||k.return()}finally{if(b)throw w}}e.stroke()}}catch(M){o=!0,h=M}finally{try{s||null==u.return||u.return()}finally{if(o)throw h}}}},{key:"componentDidMount",value:function(){var e=this;this.setState({resizeListener:window.addEventListener("resize",function(){return e.resize()})}),this.generatePaths(),this.resize(),this.tick()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.state.resizeListener),cancelAnimationFrame(this.animFunc)}},{key:"tick",value:function(){var e=this;this.animFunc=requestAnimationFrame(function(){return e.tick()});var t=performance.now(),a=this.state.then,n=this.state.speed;t-a>n&&this.setState(function(e,a){return{frame:e.frame+1,then:t}},this.draw)}},{key:"render",value:function(){return r.a.createElement("canvas",{ref:"canvas",onClick:this.handleClick,width:this.state.width,height:this.state.height,style:{border:"12px solid #c19a6b",boxSizing:"border-box",borderRadius:"12px"}})}}]),t}(r.a.Component),m=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(h.a)(this,Object(l.a)(t).call(this,e))).state={nthreads:8,ncurves:3,threadCount:150},a.handleClick=a.handleClick.bind(Object(u.a)(a)),a.change_nthreads=a.change_nthreads.bind(Object(u.a)(a)),a.change_ncurves=a.change_ncurves.bind(Object(u.a)(a)),a.change_threadCount=a.change_threadCount.bind(Object(u.a)(a)),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleClick",value:function(){this.refs.cloth.handleClick()}},{key:"change_nthreads",value:function(e){var t=this,a=e.target.value;this.setState({nthreads:a},function(){t.refs.cloth.setState({numThreads:a},function(){t.refs.cloth.generatePaths()})})}},{key:"change_ncurves",value:function(e){var t=this,a=e.target.value;this.setState({ncurves:a},function(){t.refs.cloth.setState({numCurves:a},function(){t.refs.cloth.generatePaths()})})}},{key:"change_threadCount",value:function(e){var t=this;this.setState({threadCount:e.target.value}),this.refs.cloth.setState({threadCount:e.target.value},function(){return t.refs.cloth.regenerate()})}},{key:"render",value:function(){return r.a.createElement("div",{className:"full"},r.a.createElement(f,{ref:"cloth",nthreads:this.state.nthreads,ncurves:this.state.ncurves,threadCount:this.state.threadCount}),r.a.createElement("div",{style:{float:"left"},className:"card"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"numerosity"),r.a.createElement("input",{ref:"nthreads",type:"range",className:"form-control-range",min:"1",max:"20",value:this.state.nthreads,onChange:this.change_nthreads})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"travelness"),r.a.createElement("input",{ref:"ncurves",type:"range",className:"form-control-range",min:"2",max:"10",value:this.state.ncurves,onChange:this.change_ncurves})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"luxurity"),r.a.createElement("input",{ref:"threadCount",type:"range",className:"form-control-range",min:"1",max:"250",value:this.state.threadCount,onChange:this.change_threadCount})),r.a.createElement("button",{onClick:this.handleClick,className:"btn btn-primary",type:"button"},"new threads")))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(m,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.bcf51fc0.chunk.js.map